<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Message Anniversaire</title>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Cormorant+Garamond:ital,wght@0,400;0,600;1,400;1,600&display=swap');

    * { box-sizing: border-box; margin: 0; padding: 0; }

    body {
      background: linear-gradient(135deg, #fdf6f0 0%, #fff8f5 50%, #fdf0f8 100%);
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 24px 16px;
      font-family: 'Cormorant Garamond', Georgia, serif;
      gap: 32px;
    }

    .page-wrapper {
      display: flex;
      align-items: stretch;
      justify-content: center;
      max-width: 820px;
      width: 100%;
    }

    /* â”€â”€ Fleurs grimpantes â”€â”€ */
    .flowers {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: flex-start;
      padding: 12px 0;
      min-width: 60px;
      position: relative;
    }

    .vine {
      position: relative;
      width: 52px;
      flex: 1;
    }

    .vine svg {
      width: 100%;
      height: 100%;
      overflow: visible;
    }

    .vine-stem {
      stroke-dasharray: 400;
      stroke-dashoffset: 400;
      /* durÃ©e injectÃ©e par JS */
    }

    .vine-leaf {
      opacity: 0;
      transform-box: fill-box;
      transform-origin: right center;
      /* delays injectÃ©s par JS */
    }
    .vine-leaf.l2 { transform-origin: left center; }
    .vine-leaf.l4 { transform-origin: left center; }
    .vine-leaf.l6 { transform-origin: left center; }

    .vine-flower {
      opacity: 0;
      transform-box: fill-box;
      transform-origin: center;
      /* delays injectÃ©s par JS */
    }

    @keyframes grow-stem {
      to { stroke-dashoffset: 0; }
    }
    @keyframes bloom-leaf {
      from { opacity: 0; transform: scale(0) rotate(-20deg); }
      to   { opacity: 1; transform: scale(1) rotate(0deg); }
    }
    @keyframes bloom-flower {
      from { opacity: 0; transform: scale(0); }
      to   { opacity: 1; transform: scale(1); }
    }
    @keyframes sway {
      0%, 100% { transform: rotate(0deg); }
      50%       { transform: rotate(5deg); }
    }
    @keyframes float {
      0%, 100% { transform: translateY(0); }
      50%       { transform: translateY(-3px); }
    }

    /* â”€â”€ Carte â”€â”€ */
    .card {
      background: rgba(255, 255, 253, 0.97);
      border: 1px solid rgba(200, 170, 150, 0.3);
      border-radius: 2px;
      box-shadow: 0 8px 40px rgba(120, 80, 60, 0.1), 0 2px 8px rgba(120,80,60,0.06);
      padding: 52px 52px 48px;
      flex: 1;
      position: relative;
      overflow: hidden;
    }

    .card::before {
      content: '';
      position: absolute;
      top: 12px; left: 12px; right: 12px; bottom: 12px;
      border: 1px solid rgba(180,140,60,0.18);
      border-radius: 1px;
      pointer-events: none;
    }

    .card::after {
      content: 'âœ¦';
      position: absolute;
      top: 20px; left: 50%;
      transform: translateX(-50%);
      font-size: 10px;
      color: rgba(180,140,60,0.4);
      letter-spacing: 12px;
    }

    .title {
      font-size: 1.65rem;
      font-weight: 600;
      font-style: italic;
      color: rgba(19, 52, 59, 1);
      text-align: center;
      margin-top: 18px;
      margin-bottom: 8px;
      line-height: 1.3;
    }

    .highlight { font-weight: 600; color: rgba(19, 52, 59, 1); }

    .divider {
      text-align: center;
      color: rgba(180,140,60,0.6);
      font-size: 0.85rem;
      letter-spacing: 8px;
      margin: 14px 0 22px;
    }

    .stanza {
      font-size: 1.1rem;
      font-style: italic;
      color: rgba(30,40,40,0.82);
      line-height: 1.95;
      text-align: center;
      margin-bottom: 20px;
    }

    .no-gap { margin-bottom: 4px; }

    .dynamic-link {
      display: inline-block;
      font-style: normal;
      font-size: 0.82rem;
      font-family: Georgia, serif;
      background: rgba(180,140,60,0.1);
      border: 1px solid rgba(180,140,60,0.4);
      border-radius: 20px;
      padding: 6px 20px;
      color: rgba(140,100,40,0.9);
      margin: 4px;
      vertical-align: middle;
      letter-spacing: 0.03em;
      text-decoration: none;
      transition: background 0.2s;
    }
    .dynamic-link:hover { background: rgba(180,140,60,0.22); }

    .signature {
      text-align: center;
      font-size: 1.05rem;
      font-style: italic;
      color: rgba(80,60,50,0.7);
      margin-top: 28px;
    }
    .signature .name { display: block; margin-top: 10px; }
    .signature .name img {
      height: 60px;
      width: auto;
      mix-blend-mode: multiply;
      opacity: 0.92;
      filter: contrast(2.2) brightness(0.6) saturate(1.2);
    }

    /* â”€â”€ Carousel â”€â”€ */
    .carousel-card { padding: 44px 44px 40px; }

    .carousel-title {
      font-size: 1.35rem;
      font-style: italic;
      color: rgba(19, 52, 59, 0.88);
      text-align: center;
      margin-bottom: 0;
      line-height: 1.4;
    }

    .carousel-wrapper {
      display: flex;
      align-items: center;
      margin: 0 auto;
      max-width: 560px;
    }

    .carousel-track-container {
      overflow: hidden;
      flex: 1;
      border-radius: 6px;
    }

    .carousel-track {
      display: flex;
      transition: transform 0.45s cubic-bezier(0.16, 1, 0.3, 1);
    }

    .carousel-track img {
      min-width: 100%;
      width: 100%;
      height: 320px;
      object-fit: cover;
      border-radius: 6px;
      display: block;
      flex-shrink: 0;
    }

    .carousel-track .placeholder-slide {
      min-width: 100%;
      height: 320px;
      background: linear-gradient(135deg, rgba(180,140,60,0.08), rgba(212,160,200,0.12));
      border: 2px dashed rgba(180,140,60,0.3);
      border-radius: 6px;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      gap: 10px;
      flex-shrink: 0;
    }

    .placeholder-slide .ph-icon { font-size: 2.5rem; opacity: 0.4; }
    .placeholder-slide .ph-text {
      font-family: Georgia, serif;
      font-style: italic;
      font-size: 0.82rem;
      color: rgba(140,100,40,0.6);
      letter-spacing: 0.05em;
    }

    .carousel-dots {
      display: flex;
      justify-content: center;
      gap: 7px;
      margin-top: 16px;
    }
    .carousel-dots .dot {
      width: 7px; height: 7px;
      border-radius: 50%;
      background: rgba(180,140,60,0.25);
      border: 1px solid rgba(180,140,60,0.4);
      cursor: pointer;
      transition: background 0.2s, transform 0.2s;
    }
    .carousel-dots .dot.active {
      background: rgba(180,140,60,0.75);
      transform: scale(1.25);
    }

    .insta-text {
      font-size: 1.05rem;
      font-style: italic;
      color: rgba(30,40,40,0.75);
      text-align: center;
      margin: 0;
      display: flex;
      flex-wrap: wrap;
      align-items: center;
      justify-content: center;
      gap: 10px;
    }
    .insta-link {
      font-style: normal;
      font-family: Georgia, serif;
      font-size: 0.82rem;
      background: rgba(180,140,60,0.1);
      border: 1px solid rgba(180,140,60,0.45);
      border-radius: 20px;
      padding: 5px 18px;
      color: rgba(140,100,40,0.95);
      text-decoration: none;
      letter-spacing: 0.03em;
      transition: background 0.2s;
    }
    .insta-link:hover { background: rgba(180,140,60,0.22); }

    /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       RESPONSIVE MOBILE
    â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
    @media (max-width: 640px) {
      body { padding: 16px 4px; gap: 20px; }
      .page-wrapper { gap: 0; }
      .flowers { min-width: 36px; padding: 8px 0; }
      .vine { width: 36px; }
      .card { padding: 36px 20px 32px; }
      .card::before { top: 8px; left: 8px; right: 8px; bottom: 8px; }
      .title { font-size: 1.35rem; margin-top: 12px; }
      .stanza { font-size: 1rem; line-height: 1.75; margin-bottom: 16px; }
      .divider { letter-spacing: 5px; margin: 10px 0 16px; }
      .carousel-card { padding: 32px 16px 28px; }
      .carousel-title { font-size: 1.1rem; }
      .carousel-track img, .placeholder-slide { height: 220px; }
      .carousel-wrapper { max-width: 100%; }
      .insta-text { font-size: 0.95rem; flex-direction: column; gap: 12px; }
      .dynamic-link, .insta-link { padding: 8px 20px; font-size: 0.88rem; }
      .signature { font-size: 0.95rem; margin-top: 20px; }
      .signature .name img { height: 48px; }
    }

    @media (max-width: 380px) {
      .flowers { min-width: 28px; }
      .vine { width: 28px; }
      .card { padding: 28px 14px 24px; }
      .title { font-size: 1.2rem; }
      .stanza { font-size: 0.92rem; }
      .carousel-track img, .placeholder-slide { height: 180px; }
    }
  </style>
</head>
<body>

<!-- â•â• SVG fleur grimpante (template rÃ©utilisable via JS) â•â• -->
<template id="vine-tpl">
  <div class="vine">
    <svg viewBox="0 0 52 400" fill="none" xmlns="http://www.w3.org/2000/svg" preserveAspectRatio="xMidYMid meet">
      <!-- Tige -->
      <path class="vine-stem"
        d="M26 390 Q22 340 27 300 Q32 255 24 210 Q17 165 27 120 Q35 75 26 30"
        stroke="#8B7355" stroke-width="1.3" fill="none"/>

      <!-- Feuilles gauche/droite alternÃ©es -->
      <path class="vine-leaf l1" d="M26 330 Q7 318 5 300 Q17 310 26 330Z" fill="#7a9e7e" opacity="0.72"/>
      <path class="vine-leaf l2" d="M26 290 Q45 278 47 260 Q35 270 26 290Z" fill="#7a9e7e" opacity="0.65"/>
      <path class="vine-leaf l3" d="M26 235 Q8 222 6 205 Q18 215 26 235Z" fill="#7a9e7e" opacity="0.70"/>
      <path class="vine-leaf l4" d="M26 195 Q44 182 46 165 Q34 175 26 195Z" fill="#7a9e7e" opacity="0.62"/>
      <path class="vine-leaf l5" d="M26 145 Q8 132 6 115 Q18 125 26 145Z" fill="#7a9e7e" opacity="0.68"/>
      <path class="vine-leaf l6" d="M26 105 Q44 92 46 75 Q34 85 26 105Z"  fill="#7a9e7e" opacity="0.60"/>

      <!-- Fleur rose (bas) -->
      <g class="vine-flower f1">
        <circle cx="26" cy="360" r="5.5" fill="#e8a0a0" opacity="0.55"/>
        <circle cx="26" cy="360" r="3.3" fill="#d47a7a" opacity="0.80"/>
        <ellipse cx="19" cy="356" rx="5" ry="3"   transform="rotate(-30 19 356)" fill="#e8a0a0" opacity="0.52"/>
        <ellipse cx="33" cy="356" rx="5" ry="3"   transform="rotate(30 33 356)"  fill="#e8a0a0" opacity="0.52"/>
        <ellipse cx="26" cy="350" rx="4.5" ry="3" fill="#e8a0a0" opacity="0.48"/>
        <ellipse cx="14" cy="364" rx="4" ry="2.5" transform="rotate(-50 14 364)" fill="#f0b8b8" opacity="0.42"/>
        <ellipse cx="38" cy="364" rx="4" ry="2.5" transform="rotate(50 38 364)"  fill="#f0b8b8" opacity="0.42"/>
      </g>

      <!-- Bourgeon dorÃ© (milieu) -->
      <g class="vine-flower f2">
        <path d="M20 168 Q26 156 32 168 Q30 178 26 180 Q22 178 20 168Z" fill="#e8c06a" opacity="0.78"/>
        <path d="M22 168 Q26 162 30 168" stroke="#c8a040" stroke-width="0.8" fill="none" opacity="0.6"/>
      </g>

      <!-- Fleur mauve (haut) -->
      <g class="vine-flower f3">
        <circle cx="26" cy="55"  r="5"   fill="#d4a0c8" opacity="0.62"/>
        <circle cx="26" cy="55"  r="3"   fill="#b87aaa" opacity="0.80"/>
        <ellipse cx="19" cy="51" rx="4.5" ry="2.8" transform="rotate(-30 19 51)" fill="#d4a0c8" opacity="0.52"/>
        <ellipse cx="33" cy="51" rx="4.5" ry="2.8" transform="rotate(30 33 51)"  fill="#d4a0c8" opacity="0.52"/>
        <ellipse cx="26" cy="46" rx="4"   ry="2.8" fill="#d4a0c8" opacity="0.48"/>
      </g>
    </svg>
  </div>
</template>

<!-- â•â• CARTE 1 : Intro + appareil â•â• -->
<div class="page-wrapper">
  <div class="flowers" aria-hidden="true"></div>
  <main class="card" role="main">
    <p class="title">Salut Ã  tous et <span class="highlight">joyeux anniversaire Ã  moi</span>&nbsp;! ğŸ‚</p>
    <div class="divider">âœ¦ &nbsp; âœ¦ &nbsp; âœ¦</div>
    <p class="stanza">PlutÃ´t qu'une multitude de petits cadeaux, j'ai eu une idÃ©e qui me fait vraiment rÃªver&nbsp;:</p>
    <p class="stanza">
      <span class="highlight">âœ¨ un cadeau commun âœ¨</span><br/>
      Un bel appareil photo pour immortaliser tous les moments magiques que nous partageons ensemble.
    </p>
    <p class="stanza">
      <a class="dynamic-link" href="https://www.canon.fr/cameras/eos-r1/" target="_blank" rel="noopener noreferrer">ğŸ“· Voir le cadeau</a>
    </p>
    <p class="signature">
      Avec tout mon amour,
      <span class="name"><img id="signature" alt="Maria" /></span>
    </p>
  </main>
  <div class="flowers" aria-hidden="true" style="transform:scaleX(-1)"></div>
</div>

<!-- â•â• CARTE 2 : Cagnotte â•â• -->
<div class="page-wrapper">
  <div class="flowers" aria-hidden="true"></div>
  <section class="card" aria-label="Cagnotte">
    <div class="divider" style="margin-top:8px;">âœ¦ &nbsp; âœ¦ &nbsp; âœ¦</div>
    <p class="stanza">Pour m'aider Ã  concrÃ©tiser ce beau projet,<br/>j'ai mis en place<br/><span class="highlight">ğŸ’› une cagnotte commune ğŸ’›</span></p>
    <p class="stanza">Si vous avez envie de participer, vous pouvez contribuer mais surtout sans contrainte ni minimum requis&nbsp;:<br/>chaque petit coup de pouce me touche droit au cÅ“ur. ğŸ’›</p>
    <p class="stanza" style="margin-bottom:0;">
      <a class="dynamic-link" href="https://www.canon.fr/cameras/eos-r2/" target="_blank" rel="noopener noreferrer">ğŸ’› Participer Ã  la cagnotte</a>
    </p>
  </section>
  <div class="flowers" aria-hidden="true" style="transform:scaleX(-1)"></div>
</div>

<!-- â•â• CARTE 3 : Galerie â•â• -->
<div class="page-wrapper">
  <div class="flowers" aria-hidden="true"></div>
  <section class="card carousel-card" aria-label="Galerie photos">
    <p class="carousel-title"><em>Un avant-goÃ»t des instants que je capture dÃ©jÃ â€¦</em></p>
    <div class="divider">âœ¦ &nbsp; âœ¦ &nbsp; âœ¦</div>
    <div class="carousel-wrapper">
      <div class="carousel-track-container">
        <div class="carousel-track" id="carouselTrack"></div>
      </div>
    </div>
    <div class="carousel-dots" id="carouselDots"></div>
    <p class="insta-text">
      <em>Si vous voulez en voir plus, c&rsquo;est par ici&nbsp;</em>
      <a class="insta-link" href="https://www.instagram.com/" target="_blank" rel="noopener noreferrer">ğŸ“· Mon Instagram</a>
    </p>
  </section>
  <div class="flowers" aria-hidden="true" style="transform:scaleX(-1)"></div>
</div>

<script>
  // â”€â”€ Signature â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  const SIG_URL = "https://i.ibb.co/Rpt7LQp2/IMG-5756-Any-Eraser.png";
  document.getElementById("signature").src = SIG_URL;

    // â•â• Variable unique : changer ce chiffre suffit â•â•
  const GROW_DURATION = 20; // secondes

  // â”€â”€ Injection des fleurs grimpantes â”€â”€â”€â”€â”€â”€â”€â”€
  const tpl = document.getElementById('vine-tpl');
  document.querySelectorAll('.flowers').forEach(el => {
    el.appendChild(tpl.content.cloneNode(true));
  });


  function applyVineAnimations() {
    const d = GROW_DURATION;

    const leafDelays = [
      d * 0.35,  // l1 â€” bas gauche
      d * 0.45,  // l2 â€” bas droite
      d * 0.54,  // l3 â€” milieu gauche
      d * 0.63,  // l4 â€” milieu droite
      d * 0.72,  // l5 â€” haut gauche
      d * 0.81,  // l6 â€” haut droite
    ];

    const flowerDelays = [
      d * 0.85,  // f1 â€” fleur rose (bas)
      d * 0.92,  // f2 â€” bourgeon dorÃ© (milieu)
      d * 1.00,  // f3 â€” fleur mauve (haut)
    ];

    const swayStart = d + 2;

    // Traiter chaque vine individuellement
    document.querySelectorAll('.vine').forEach(vine => {

      vine.querySelectorAll('.vine-stem').forEach(el => {
        el.style.animation = `grow-stem ${d}s ease-in-out forwards`;
      });

      vine.querySelectorAll('.vine-leaf').forEach((el, i) => {
        const ld = leafDelays[i] ?? leafDelays[leafDelays.length - 1];
        el.style.animation = `bloom-leaf 0.6s ease-out ${ld}s forwards, sway 3.5s ease-in-out ${swayStart + i * 0.2}s infinite`;
      });

      vine.querySelectorAll('.vine-flower').forEach((el, i) => {
        const fd = flowerDelays[i] ?? flowerDelays[flowerDelays.length - 1];
        el.style.animation = `bloom-flower 0.8s cubic-bezier(0.34,1.56,0.64,1) ${fd}s forwards, float 4s ease-in-out ${swayStart + 1 + i * 0.5}s infinite`;
      });

    });
  }

  applyVineAnimations();

  // â”€â”€ Carousel â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  let currentSlide = 0;
  const track = document.getElementById('carouselTrack');
  const dotsContainer = document.getElementById('carouselDots');

  function goToSlide(index) {
    const total = track.children.length;
    if (total === 0) return;
    currentSlide = (index + total) % total;
    track.style.transform = `translateX(-${currentSlide * 100}%)`;
    document.querySelectorAll('.dot').forEach((d, i) => d.classList.toggle('active', i === currentSlide));
  }

  function moveCarousel(dir) { goToSlide(currentSlide + dir); }

  function initCarousel() {
    fetch('./galerie/images_referentiel.json')
      .then(res => { if (!res.ok) throw new Error(); return res.json(); })
      .then(files => {
        if (!files || files.length === 0) throw new Error();
        files.forEach((filename, i) => {
          const img = document.createElement('img');
          img.src = filename;
          img.alt = 'Photo ' + (i + 1);
          img.onerror = function() {
            const ph = document.createElement('div');
            ph.className = 'placeholder-slide';
            ph.innerHTML = `<span class="ph-icon">ğŸ“·</span><span class="ph-text">${filename} introuvable</span>`;
            track.replaceChild(ph, img);
          };
          track.appendChild(img);
          const dot = document.createElement('div');
          dot.className = 'dot' + (i === 0 ? ' active' : '');
          dot.onclick = () => goToSlide(i);
          dotsContainer.appendChild(dot);
        });
      })
      .catch(() => {
        track.innerHTML = `<div class="placeholder-slide"><span class="ph-icon">ğŸ“·</span><span class="ph-text">CrÃ©ez galerie/images_referentiel.json avec la liste de vos photos</span></div>`;
      });
  }

  // DÃ©filement automatique
  let autoPlay = setInterval(() => moveCarousel(1), 3000);
  const wrapper = document.querySelector('.carousel-wrapper');
  wrapper.addEventListener('mouseenter', () => clearInterval(autoPlay));
  wrapper.addEventListener('mouseleave', () => { autoPlay = setInterval(() => moveCarousel(1), 3000); });

  // Swipe tactile
  let touchStartX = 0;
  track.addEventListener('touchstart', e => { touchStartX = e.touches[0].clientX; clearInterval(autoPlay); });
  track.addEventListener('touchend', e => {
    const diff = touchStartX - e.changedTouches[0].clientX;
    if (Math.abs(diff) > 40) moveCarousel(diff > 0 ? 1 : -1);
    autoPlay = setInterval(() => moveCarousel(1), 3000);
  });

  initCarousel();
</script>
</body>
</html>
